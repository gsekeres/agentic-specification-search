# Specification Surface Review: 125321-V1

## Paper: Can Technology Solve the Principal-Agent Problem? Evidence from China's War on Air Pollution (Greenstone, He, Jia, Liu, AER 2022)

## Summary of Baseline Groups

**G1**: Sharp RD effect of automation on reported PM10 pollution at the station automation date. Running variable T = date - auto_date (days), cutoff = 0, local linear with triangular kernel and MSE-optimal (CCFT) bandwidth. Outcome is residualized PM10 (partialling out station FE, month FE, and weather controls). Clustered at city level.

Single baseline group is appropriate. The claim object (local effect of automation on reported PM10) is consistent across Table 1A columns.

### Changes to baseline spec IDs

**Moved `baseline__monthly_aod` from baseline to diagnostics.** The AOD (Aerosol Optical Depth) outcome measures satellite-observed pollution, which should *not* change at the automation date. The paper uses this explicitly as a falsification check ("the satellite-measured AOD does not show a discontinuity, confirming that real pollution did not change"). This is a placebo outcome diagnostic, not a separate baseline claim. It has been added to `diagnostics_plan` as `diag/regression_discontinuity/placebo_outcome/aod_satellite`.

The remaining additional baseline `baseline__raw_pm10` (unresidualized RD on raw PM10, Table 1A Row1 Col1) is appropriate as a baseline variant since it estimates the same claim object without the pre-residualization step.

## Changes Made

### A) Removed redundant design spec IDs

1. **Removed `design/regression_discontinuity/poly/local_linear`**: The baseline already uses p(1) local linear estimation. This would duplicate the baseline.

2. **Removed `design/regression_discontinuity/kernel/triangular`**: The baseline already uses a triangular kernel. Redundant.

### B) Cleaned up redundant/ambiguous RC spec IDs

1. **Renamed `rc/controls/sets/none` to `rc/controls/sets/none_no_residualization`**: Clarifies that this spec runs rdrobust on raw PM10 without any prior residualization. This is equivalent to `baseline__raw_pm10` but may differ in implementation details; the runner should check for overlap.

2. **Renamed `rc/controls/sets/weather_only` to `rc/controls/sets/weather_only_no_fe`**: Clarifies that this residualizes PM10 from weather controls only (no station/month FE), making it distinct from the baseline.

3. **Removed `rc/controls/sets/weather_and_fe`**: This was identical to the baseline's residualization step (station FE + month FE + weather controls). Redundant.

4. **Removed `rc/form/outcome/level_pm10`**: The baseline already uses level PM10 (residualized). This was ambiguous -- if it meant "unresidualized level," it duplicates `rc/controls/sets/none_no_residualization` and `baseline__raw_pm10`. Removed to avoid confusion.

5. **Removed `rc/fe/alt/station_month_fe`**: The baseline already uses station FE + month FE in the residualization step. This was redundant unless it meant station-by-month interaction FE, which is not attested in the code. Kept `rc/fe/alt/station_yearmonth_fe` since the paper's Table 1B DiD columns use year-month FE.

### C) Added data construction note

Added `data_construction_note` to constraints explaining that `station_day_1116.dta` and `station_month.dta` are generated by `Prepare_Data.do` from raw source files. The runner needs to replicate this merge.

### D) Budget adjustment

Reduced `max_specs_core_total` from 60 to 55. Revised count: 7 design specs + 14 RC specs + 1 baseline + 1 additional baseline (raw_pm10) = 23 enumerated specs, well within budget. Headroom allows for any additional specs discovered during execution.

## Key Constraints and Linkage Rules

- **No linkage constraints**: Single-equation RD; no bundled components.
- **Residualization is the primary control variation axis**: Controls do not enter rdrobust directly; they enter through a pre-residualization step using reghdfe. Varying controls means re-running the reghdfe step and then rdrobust on the new residuals.
- **Bandwidth**: MSE-optimal by default (CCFT procedure in rdrobust). Half/double bandwidth variants are standard sensitivity checks.
- **Kernel and polynomial**: Triangular/p(1) is the baseline; uniform, Epanechnikov, and local quadratic are standard RD variants. Code confirms all three kernels are used in Table B3.

## Budget and Sampling Assessment

- Total enumerated specs: ~23, well within budget of 55.
- No control-subset sampling needed: the control pool has only 4 weather variables, making full enumeration trivial.
- The universe is fully tractable.

## What's Missing

1. **Parametric RD specifications**: Table B3 in the paper also reports parametric (global polynomial) RD estimates using reghdfe with an `after` indicator and polynomial trends in T. These are a distinct estimator variant (`design/regression_discontinuity/procedure/parametric_global`) that could be added. Not blocking.

2. **SO2/NO2 placebo outcomes**: Table B7 uses SO2 and NO2 as placebo outcomes. These could be added to the diagnostics plan. Not blocking.

3. **Table B8 (missing data sensitivity)**: The paper varies the threshold for pre-period missing PM10 rates. This is a data construction/sample restriction axis that could be added as additional `rc/sample/restrict/` variants. Not blocking.

## Verification Against Code

- **Running variable and cutoff**: Verified in `Tables.do` lines 13-14: `gen T=date-auto_date` and `rdrobust ... c(0)`.
- **Estimation**: `rdrobust resid_pm10_smw T, c(0) p(1) q(2) kernel(tri) vce(cluster code_city) masspoints(off)` -- matches design_audit exactly (p=1, q=2, triangular, cluster city).
- **Residualization**: `reghdfe pm10 wind_speed rain temp rh, absorb(pm10_n month) res(resid_pm10_smw)` -- confirmed station FE + month FE + 4 weather controls.
- **Wave restrictions**: Code uses `if phase==1` and `if phase==2` for wave-specific estimates.
- **Deadline cities**: Code uses `if auto_date==19359 | auto_date==19724` for deadline subsamples.
- **76 cities**: Code uses `if list_76==1` variable generated in Prepare_Data.do.
- **Kernel alternatives**: Table B2 code in TS.do confirms triangular, Epanechnikov (`epa`), and uniform (`uni`) kernels.
- **Monthly AOD**: `Tables.do` lines 33-47 confirm rdrobust on residualized AOD at station-month level with `n_month` running variable.
- **Dataset**: `station_day_1116.dta` is generated by merging `pollution_1116.dta` + `weather_1116.dta` + `station_list.dta` in `Prepare_Data.do`.

## Final Assessment

**Approved to run.** The surface is conceptually coherent and faithful to the paper's RD design. Key changes: (1) moved AOD from baseline to diagnostics (it is a falsification check, not the main claim), (2) removed 5 redundant or ambiguous spec IDs, (3) added data construction notes. No blocking issues.
